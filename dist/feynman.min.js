/*! feynman 2014-05-09 */
!function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);throw new Error("Cannot find module '"+g+"'")}var j=c[g]={exports:{}};b[g][0].call(j.exports,function(a){var c=b[g][1][a];return e(c?c:a)},j,j.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b){b.exports=function(){function a(a,b,c){if("undefined"==typeof b)throw new Error("Missing canvas argument.");if("undefined"==typeof c)throw new Error("Missing data argument.");return this.canvasId=a,this.canvas=b,this.data=c,this}a.prototype.draw=function(){g.bind(this)(),h.bind(this)(),c.bind(this)(),d.bind(this)(),f.bind(this)(),e.bind(this)()},a.prototype.getVertexById=function(a){var b;return this.data.vertices.forEach(function(c){c.id===a&&(b=c)}),b},a.prototype.getControlPointById=function(a){var b;for(var c in this.data.cPoints)this.data.cPoints.hasOwnProperty(c)&&this.data.cPoints[c].forEach(function(c){c.id===a&&(b=c)});return b},a.prototype.getParticlesStartingFromPoint=function(a){return b.bind(this)("from",a)},a.prototype.getParticlesEndingInPoint=function(a){return b.bind(this)("to",a)},a.prototype.getParticlePathsFromControlPoint=function(){};var b=function(a,b){var c=[];return this.data.particles.forEach(function(d){d[a]===b&&c.push(d)}),c},c=function(){this.canvas.size(this.data.width,this.data.height)},d=function(){var a=this.canvas.group();a.text(this.data.title).font({family:"Georgia",size:14,style:"italic",anchor:"left"}).translate(10,10)},e=function(){this.canvas.group()},f=function(){this.canvas.group()},g=function(){for(var a in this.data.cPoints)if(this.data.cPoints.hasOwnProperty(a)){var b="left"===a||"right"===a?this.data.height:this.data.width,c="left"===a||"right"===a?this.data.width:this.data.height,d="left"===a||"right"===a?"x":"y",e="left"===a||"right"===a?"y":"x",f="right"===a||"bottom"===a?-1:1,g=1===this.data.cPoints[a].length?3:this.data.cPoints[a].length,h=.4*b/2,i=.6*b/(g-1),j=1===this.data.cPoints[a].length?1:0;this.data.cPoints[a].forEach(function(a){a[d]=-1===f?c-h:h,a[e]=j*i+h,j++})}},h=function(){this.data.cPoints.left.forEach(function(a){this.getParticlePathsFromControlPoint(a)},this),this.data.cPoints.top.forEach(function(a){this.getParticlePathsFromControlPoint(a)},this)};return a}()},{}],2:[function(a,b){var c=a("./helpers/Klass");b.exports={getStructure:function(){return c.__clone({title:"",width:200,height:150,thickness:"thick",particles:[],vertices:[],cPoints:{left:[],right:[],top:[],bottom:[]}})}}},{"./helpers/Klass":3}],3:[function(a,b){var c={}.hasOwnProperty;b.exports={__extends:function(a,b){function d(){this.constructor=a}for(var e in b)c.call(b,e)&&(a[e]=b[e]);return d.prototype=b.prototype,a.prototype=new d,a.__super__=b.prototype,a},__clone:function(a){if(null==a||"object"!=typeof a)return a;var b=a.constructor();for(var c in a)a.hasOwnProperty(c)&&(b[c]=a[c]);return b}}},{}],4:[function(a,b){var c=a("./parsers/ParserFactory"),d=a("./Stage");b.exports=function(){var a=function(){return this};return a.prototype.draw=function(a,b){if("undefined"==typeof a)throw new Error("Missing canvas#id argument!");if("undefined"==typeof b)throw new Error("Missing data argument!");var e=new SVG(a),f=c.getParser(b),g=f.parse(),h=new d(a,e,g);return h.draw(),this},window.Feynman=a,a}()},{"./Stage":1,"./parsers/ParserFactory":6}],5:[function(a,b){{var c=a("./../StageStructure");a("./../helpers/Klass")}b.exports=function(){function a(a){if("undefined"==typeof a)throw new Error("No data given.");return this.raw=a,b=c.getStructure(),this}var b;a.prototype.parse=function(){return this.raw.title&&(b.title=this.raw.title),this.raw.width&&(b.width=this.raw.width),this.raw.height&&(b.height=this.raw.height),this.raw.diagram&&this.raw.diagram.forEach(function(a){d(a)}),b};var d=function(a){var b=a.match(/\w+/g)[0],c=a.match(/(\{\w+([^\}\{]|\d?)+?\})/g),d=u(t(c));void 0!==b&&void 0!==z[b]&&z[b](d)},e=function(a){for(var c=0;a[1][c+1];){var d=a[1][c],e=a[1][c+1],f="p"+(b.particles.length+1);s(d),s(e);var g=w(a[0].slice(1)),h={id:f,from:d,to:e,type:a[0][0],label:g.label,labelSide:g.side,labelDistance:g.dist,tension:g.tension,right:g.right,tag:g.tag,color:g.foreground,bgColor:g.background,penWidth:g.width};b.particles.push(h),c++}},f=function(a,c){c[0].forEach(function(c){y(c)||b.cPoints[a].push({id:c,x:0,y:0,side:a})})},g=function(a){f("right",a)},h=function(a){f("left",a)},i=function(a){f("top",a)},j=function(a){f("bottom",a)},k=function(a,b){for(var c=parseInt(b[0],10),d=[],e=1,g="left"===a||"top"===a?"i":"o";c>=e;)d.push(g+e),e++;f(a,[d])},l=function(a){k("right",a)},m=function(a){k("left",a)},n=function(a){k("top",a)},o=function(a){k("bottom",a)},p=function(a){a[0].forEach(function(a){var b=x(a);b&&(b.visible=!0)})},q=function(a){("thick"===a[0][0]||"thin"===a[0][0])&&(b.thickness=a[0][0])},r=function(a){return"v"===a[0]},s=function(a){r(a)&&!x(a)&&b.vertices.push({id:a})},t=function(a){var b=/\{|\}/g;return a.map(function(a){return a.replace(b,"")})},u=function(a){var b=[];return a.forEach(function(a){var c=a.split(",");c=v(c),b.push(c)}),b},v=function(a){var b=[];return a.forEach(function(a){var c=a,d=/(\w+)\=(\S+)/g,e=d.exec(c);if(e&&e.length>2){var f=e[1],g=e[2];c={},c[f]=g}b.push(c)}),b},w=function(a){var b={};return a&&0===a.length?b:(a.forEach(function(a){if("string"==typeof a&&(b[a]=!0),"object"==typeof a){var c=Object.keys(a)[0];b[c]="undefined"==typeof a[c]?!0:a[c]}}),b)},x=function(a){var c;return b.vertices.forEach(function(b){b.id===a&&(c=b)}),c},y=function(a){var c;for(var d in b.cPoints)b.cPoints.hasOwnProperty(d)&&b.cPoints[d].forEach(function(b){b.id===a&&(c=b)});return c},z={fmf:e,fmfbottom:j,fmfbottomn:o,fmfdot:p,fmfleft:h,fmfleftn:m,fmfpen:q,fmfright:g,fmfrightn:l,fmftop:i,fmftopn:n};return a}()},{"./../StageStructure":2,"./../helpers/Klass":3}],6:[function(a,b){var c=a("./LatexParser");b.exports={getParser:function(a){switch(a.lang){default:return new c(a)}}}},{"./LatexParser":5}]},{},[4]);