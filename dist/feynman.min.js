/*! feynman 2014-04-08 */
!function(a){"object"==typeof exports?module.exports=a():"function"==typeof define&&define.amd?define(a):"undefined"!=typeof window?window.Feynman=a():"undefined"!=typeof global?global.Feynman=a():"undefined"!=typeof self&&(self.Feynman=a())}(function(){return function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);throw new Error("Cannot find module '"+g+"'")}var j=c[g]={exports:{}};b[g][0].call(j.exports,function(a){var c=b[g][1][a];return e(c?c:a)},j,j.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b){var c=a("./ParticleGenerator");b.exports=function(){var a=function(a,c,d,e){if(void 0===a)throw new Error("Missing id argument!");if(void 0===c||void 0===d)throw new Error("Exchange must have both an inbound and outbound attribute!");if(void 0===e||0===e.length)throw new Error("No particles given!");return this.id=a,this.inbound=c,this.outbound=d,this.particles=[],b(this,e),this};a.prototype.draw=function(a){this.particles.forEach(function(b){b.draw(a)})};var b=function(a,b){b.forEach(function(b){var d=c.getParticle(b);void 0!==d&&a.particles.push(d)})};return a}()},{"./ParticleGenerator":2}],2:[function(a,b){var c=a("./propagators/Electron"),d=a("./propagators/Quark"),e=a("./propagators/Gluon"),f=a("./propagators/Photon");b.exports={getParticle:function(a){if(void 0===a)throw new Error("Missing data argument!");return"e-"===a.type?new c(a.id,!1,a.color,a.length):"e+"===a.type?new c(a.id,!0,a.color,a.length):"q"===a.type?new d(a.id,!1,a.color,a.length):"aq"===a.type?new d(a.id,!0,a.color,a.length):"g"===a.type?new e(a.id,a.color,a.length):"ph"===a.type?new f(a.id,a.color,a.length):void 0}}},{"./propagators/Electron":13,"./propagators/Gluon":14,"./propagators/Photon":15,"./propagators/Quark":16}],3:[function(a,b){b.exports=function(){var a=function(){return this.title="Feynman",this.layout="time-space",this.width=100,this.height=100,this.showAxes=!0,this.propagators=[],this.vertices=[],this.exchanges=[],this};a.prototype.setCanvas=function(a){return this.canvas=a,this.canvas.size(this.width,this.height),this},a.prototype.draw=function(){return b(this),c(this),d(this),e(this),this};var b=function(a){a.canvas.text(a.title).font({family:"Helvetica",size:14,anchor:"left"})},c=function(a){a.vertices.forEach(function(b){b.draw(a.canvas)})},d=function(a){a.propagators.forEach(function(b){b.draw(a.canvas)})},e=function(a){a.exchanges.forEach(function(b){b.draw(a.canvas)})};return a}()},{}],4:[function(a,b){b.exports=function(){var a=function(a,b,c){if(void 0===a)throw new Error("Missing id argument!");if(void 0===b&&void 0===c)throw new Error("Vertices must have either an inbound or outbound attribute!");if(void 0!==b&&0===b.length&&void 0!==c&&0===c.length)throw new Error("Vertices must have either an inbound or outbound attribute!");return this.id=a,this.inbound=b||[],this.outbound=c||[],this};return a.prototype.draw=function(a){a.circle(3).fill({color:"#000"})},a}()},{}],5:[function(a,b){var c=a("./Vector"),d=Math.PI;b.exports={line:function(a,b,d){for(var e=["M"],f=Math.floor(d/b),g=d-b*f+.1,h=0;f>=h;h++)for(var i,j=0,k=a.length;k>j;j++)if(i=a[j],"[object Array]"===Object.prototype.toString.call(i)){if(!(f>h||i[0]<g))break;e.push(c.normalize(i[0]+b*h,",",i[1]))}else e.push(i);return e.join(" ").replace(/\s[A-Z][^A-Z]*$/,"")},arc:function(a,b,e,f){for(var g=2,h=.25*Math.max(g,2),i=Math.acos(-.5/h),j=-2*Math.asin(e/(h*f)),k=[],l=["M","0,0"],m=0;(d-2*i)/j>=m;m++)k.push([f*(h*Math.cos(j*m+i)+.5),f*(h*Math.sin(j*m+i)-Math.sqrt(h*h-.25))]);for(var n,o=0,p=k.length-1;p>o;o++){n="photon"===a?b[o%2]:b;for(var q,r=0,s=n.length;s>r;r++)q=n[r],l.push("object"==typeof q?c.getPoint(k[o][0],k[o][1],k[o+1][0],k[o+1][1],q[0],q[1]):q)}return l.join(" ").replace(/\s[A-Z]$/,"")},loop:function(){}}},{"./Vector":7}],6:[function(a,b){var c={}.hasOwnProperty;b.exports={__extends:function(a,b){function d(){this.constructor=a}for(var e in b)c.call(b,e)&&(a[e]=b[e]);return d.prototype=b.prototype,a.prototype=new d,a.__super__=b.prototype,a}}},{}],7:[function(a,b){b.exports={normalize:function(){for(var a,b="",c=0,d=arguments.length;d>c;c++)a=arguments[c],b+=" "+("number"!=typeof a?a:a.toFixed(3).replace(/(.\d*?)0+$/,"$1").replace(/\.$/,""));var e=b.trim();return e.replace(/ ?, ?/g,",")},getPoint:function(a,b,c,d,e,f){var g=Math.atan2(d-b,c-a);return this.normalize(e*Math.cos(g)-f*Math.sin(g)+a,",",e*Math.sin(g)+f*Math.cos(g)+b)}}},{}],8:[function(a,b){var c=a("./parsers/ParserFactory");b.exports=function(){var a=function(){return this};return a.prototype.draw=function(a,b){if("undefined"==typeof a)throw new Error("Missing canvas#id argument!");if("undefined"==typeof b)throw new Error("Missing data argument!");var d=new SVG(a),e=c.getParser(b.lang),f=e.parse(b);return f.setCanvas(d).draw(),this},a}()},{"./parsers/ParserFactory":10}],9:[function(a,b){var c=a("./../Stage");b.exports=function(){var a=function(){return this};return a.prototype.parse=function(a){if(void 0===a)throw new Error("Missing data argument!");return new c},a}()},{"./../Stage":3}],10:[function(a,b){var c=a("./StandardParser"),d=a("./LatexParser");b.exports={getParser:function(a){return"latex"===a?new d:new c}}},{"./LatexParser":9,"./StandardParser":11}],11:[function(a,b){var c=a("./../Stage"),d=a("./../ParticleGenerator"),e=a("./../Vertex"),f=a("./../Exchange");b.exports=function(){var a=function(){return this};a.prototype.parse=function(a){if(void 0===a)throw new Error("Missing data argument!");var d=new c;return b(d,a.title),g(d,a.layout),h(d,a.width,a.height),i(d,a.showAxes),j(d,a.propagators),k(d,a.vertices),l(d,a.exchanges),d};var b=function(a,b){void 0!==b&&(a.title=b)},g=function(a,b){void 0!==b&&(a.layout=b)},h=function(a,b,c){void 0!==b&&(a.width=b),void 0!==c&&(a.height=c)},i=function(a,b){void 0!==b&&(a.showAxes=b)},j=function(a,b){if(void 0===b)throw new Error("Missing propagators!");b.forEach(function(b){var c=d.getParticle(b);void 0!==c&&a.propagators.push(c)})},k=function(a,b){if(void 0===b)throw new Error("Missing vertices!");b.forEach(function(b){var c=new e(b.id,b.inbound,b.outbound);void 0!==c&&a.vertices.push(c)})},l=function(a,b){return void 0===b?[]:(b.forEach(function(b){var c=new f(b.id,b.inbound,b.outbound,b.particles);void 0!==c&&a.exchanges.push(c)}),void 0)};return a}()},{"./../Exchange":1,"./../ParticleGenerator":2,"./../Stage":3,"./../Vertex":4}],12:[function(a,b){b.exports=function(){var a="#000",b=100,c=function(c,d,e,f){if(void 0===c)throw new Error("Missing id argument!");return this.anti=d,this.color=e||a,this.length=f||b,this};return c.prototype.draw=function(){throw new Error("Cannot call abstract method!")},c.prototype.getPath=function(){throw new Error("Cannot call abstrect method!")},c}()},{}],13:[function(a,b){var c=a("./../helpers/Klass"),d=a("./AbstractParticle");b.exports=function(a){function b(a,c,d,e){b.__super__.constructor.apply(this,[a,c||!1,d,e])}return c.__extends(b,a),b.prototype.draw=function(a){a.line(0,0,this.length,0).fill(this.color).stroke({width:1,color:this.color});var b,c,d,e,f,g,h;c=this.length/2+5,f=0,d=this.length/2-5,g=3,e=this.length/2-5,h=-3,b=""+c+","+f+" "+d+","+g+" "+e+","+h,a.polygon(b).fill(this.color)},b}(d)},{"./../helpers/Klass":6,"./AbstractParticle":12}],14:[function(a,b){var c=a("./../helpers/Klass"),d=a("./AbstractParticle");b.exports=function(a){function b(a,c,d){b.__super__.constructor.apply(this,[a,void 0,c||"#009933",d||96])}return c.__extends(b,a),b.prototype.draw=function(a){for(var b=12,c=Math.floor(this.length/b),d="",e=0;c>e;e++)0===e&&(d+="M"),d+=12*e+",1 Q"+(12*e+3)+",1 "+(12*e+6)+",2 Q"+(12*e+9)+",4 "+(12*e+10)+",9 Q"+(12*e+12)+",15 "+(12*e+6)+",15 Q"+12*e+",15 "+(12*e+2)+",9 Q"+(12*e+3)+",4 "+(12*e+6)+",2 Q"+(12*e+9)+",1 ",e+1===c&&(d+=12*e+12+",0");return a?(a.path(d,!0).fill("none").stroke({width:1,color:this.color}),this):d},b}(d)},{"./../helpers/Klass":6,"./AbstractParticle":12}],15:[function(a,b){var c=a("./../helpers/Klass"),d=a("./AbstractParticle"),e=a("./../helpers/Bezier");b.exports=function(a){function b(a,c,d){b.__super__.constructor.apply(this,[a,void 0,c||"#0066FF",d||120])}return c.__extends(b,a),b.prototype.draw=function(a){var b=this.getPath(this.length,"line");a.path(b,!0).transform({x:30,y:20}).fill("none").stroke({width:1,color:this.color})},b.prototype.getPath=function(a,b){var c=Math.PI,d=.51128733,f=5,g=.5*d*f,h=5,i=2*h/c,j=d*h/c,k=!1,l=k?[[0,0],"C",[j,-g],[i,-f],[h,-f],"S",[2*h-j,-g],[2*h,0],"S",[2*h+i,f],[3*h,f],"S",[4*h-j,g]]:[[0,0],"C",[j,g],[i,f],[h,f],"S",[2*h-j,g],[2*h,0],"S",[2*h+i,-f],[3*h,-f],"S",[4*h-j,-g]],m=k?[["C",[j,-g],[i,-f],[h,-f],"S",[2*h-j,-g],[2*h+.5,0]],["C",[j,g],[i,f],[h,f],"S",[2*h-j,-g],[2*h-.5,0]]]:[["C",[j,g],[i,f],[h,f],"S",[2*h-j,g],[2*h-.5,0]],["C",[j,-g],[i,-f],[h,-f],"S",[2*h-j,-g],[2*h+.5,0]]];switch(b){case"line":return e.line(l,4*h,a);case"arc":return e.arc("photon",m,h,a)}},b}(d)},{"./../helpers/Bezier":5,"./../helpers/Klass":6,"./AbstractParticle":12}],16:[function(a,b){var c=a("./../helpers/Klass"),d=a("./AbstractParticle");b.exports=function(a){function b(a,c,d,e){b.__super__.constructor.apply(this,[a,c||!1,d,e])}return c.__extends(b,a),b.prototype.draw=function(){},b}(d)},{"./../helpers/Klass":6,"./AbstractParticle":12}]},{},[8])(8)});